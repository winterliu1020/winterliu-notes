```java
Random random = new Random();
```

我们一般上面这行代码来获得随机数，这里声明一个random对象，如果构造函数中不传递参数则使用默认的种子，这个种子就是一个long类型的数字，有了种子之后。

![](https://winterliublog.oss-cn-beijing.aliyuncs.com/winterliu-notes/concurrent/20201009175236.png)

在单线程下都是先根据老种子生成新种子，然后用新种子传递到一个固定的函数中得到一个随机数。但是如果是多线程，多个线程可能都拿到同一个老的种子去执行步骤4以计算新的种子，导致多个线程得到的新种子是一样的。因为步骤5根据种子获取随机数的算法是固定的，这样就导致多个线程产生相同的随机值。

**所以我们要保证步骤四（产生新种子）的原子性**，也就是说当有多个线程根据同一个老种子计算新种子时，第一个线程的新种子被计算出来之后，第二个线程要丢弃自己老的种子，而使用第一个线程产生的新种子来计算自己的新种子。这样保证了多个线程产生的随机数是随机的。在这里，Random函数使用了一个**原子变量**实现这个效果。

































